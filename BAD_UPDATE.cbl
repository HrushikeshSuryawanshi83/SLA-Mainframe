IDENTIFICATION DIVISION.
       PROGRAM-ID. BADUPDT.
       
       DATA DIVISION.
       WORKING-STORAGE SECTION.
       01  WS-COUNTER       PIC 9(4) VALUE 0.
       
       PROCEDURE DIVISION.
       MAIN-LOGIC.
           DISPLAY 'STARTING HEAVY PROCESSING...'.

           * --- SIMULATING HEAVY SQL USAGE (20 Calls) ---
           EXEC SQL SELECT * FROM EMPLOYEE END-EXEC.
           EXEC SQL SELECT * FROM SALARY END-EXEC.
           EXEC SQL UPDATE EMPLOYEE SET STATUS = 'A' END-EXEC.
           EXEC SQL FETCH NEXT FROM CURSOR1 END-EXEC.
           EXEC SQL FETCH NEXT FROM CURSOR1 END-EXEC.
           EXEC SQL COMMIT END-EXEC.
           EXEC SQL SELECT * FROM HISTORY END-EXEC.
           EXEC SQL INSERT INTO LOGS VALUES('A') END-EXEC.
           EXEC SQL UPDATE COUNTS SET C = C + 1 END-EXEC.
           EXEC SQL SELECT MAX(ID) FROM TRANS END-EXEC.
           EXEC SQL CLOSE CURSOR1 END-EXEC.
           EXEC SQL OPEN CURSOR2 END-EXEC.
           EXEC SQL FETCH CURSOR2 END-EXEC.
           EXEC SQL UPDATE AUDIT SET TIME = NOW() END-EXEC.
           EXEC SQL SELECT COUNT(*) FROM USERS END-EXEC.
           EXEC SQL DELETE FROM TEMP_CACHE END-EXEC.
           EXEC SQL COMMIT END-EXEC.
           EXEC SQL ROLLBACK END-EXEC.
           EXEC SQL SELECT * FROM CONFIG END-EXEC.
           EXEC SQL CLOSE CURSOR2 END-EXEC.

           * --- SIMULATING HEAVY I/O (10 Reads/Writes) ---
           READ FILE-IN.
           READ FILE-IN.
           READ FILE-IN.
           WRITE RECORD-OUT.
           WRITE RECORD-OUT.
           REWRITE RECORD-OUT.
           READ FILE-IN.
           READ FILE-IN.
           WRITE RECORD-LOG.
           WRITE RECORD-LOG.

           * --- SIMULATING COMPLEX LOOPS (Repeated Logic) ---
           PERFORM VARYING WS-COUNTER FROM 1 BY 1 UNTIL WS-COUNTER > 500
               DISPLAY 'LOOPING...'
           END-PERFORM.

           STOP RUN.